{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Workflow Schema",
  "description": "Schema for composite validation workflows",
  "type": "object",
  "required": ["workflow_id", "name", "mode", "steps"],
  "properties": {
    "workflow_id": {
      "type": "string",
      "description": "Unique identifier for the workflow",
      "examples": ["research_validation", "planning_validation"]
    },
    "name": {
      "type": "string",
      "description": "Human-readable name",
      "examples": ["Base Research Validation", "GIST Planning Validation"]
    },
    "description": {
      "type": "string",
      "description": "What this workflow does"
    },
    "mode": {
      "type": "string",
      "description": "Workflow execution mode",
      "enum": ["validation", "conversational", "hybrid"]
    },
    "steps": {
      "type": "array",
      "description": "Ordered list of technique steps",
      "items": {
        "type": "object",
        "required": ["step", "technique"],
        "properties": {
          "step": {
            "type": "integer",
            "description": "Step number (1-indexed)",
            "minimum": 1
          },
          "technique": {
            "type": "string",
            "description": "Technique ID to execute"
          },
          "on_fail": {
            "type": "string",
            "description": "What to do if technique fails",
            "enum": ["stop", "continue", "warn"],
            "default": "continue"
          },
          "output": {
            "type": "string",
            "description": "How to handle technique output",
            "enum": ["save_to_context", "discard", "final"],
            "default": "save_to_context"
          },
          "context_from_previous": {
            "type": "boolean",
            "description": "Whether to pass previous step output as context",
            "default": false
          }
        }
      }
    },
    "reasoning_strategy": {
      "type": "string",
      "description": "Advanced reasoning mode to use",
      "enum": ["DIRECT", "CoT", "ToT", "Self-Correction"],
      "default": "DIRECT"
    },
    "recommended_model": {
      "type": "string",
      "description": "Recommended model tier for this workflow",
      "enum": ["tier1_fast", "tier2_deep", "tier3_overnight"]
    },
    "output_aggregation": {
      "type": "string",
      "description": "How to combine step outputs",
      "enum": ["merge_all", "last_only", "custom"],
      "default": "merge_all"
    },
    "temperature": {
      "type": "number",
      "description": "Override temperature for all steps",
      "minimum": 0.0,
      "maximum": 2.0
    },
    "use_cases": {
      "type": "array",
      "description": "When to use this workflow",
      "items": {
        "type": "string"
      }
    },
    "tags": {
      "type": "array",
      "description": "Categorization tags",
      "items": {
        "type": "string"
      }
    }
  }
}
